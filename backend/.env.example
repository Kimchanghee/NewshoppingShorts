# Security Configuration
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!

# Admin API Key (generate a strong random key)
# Used for admin dashboard authentication
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
ADMIN_API_KEY=your-secure-admin-key-here-change-this

# Dedicated API key for CI/CD update metadata endpoint (/app/version/update)
# Must be different from ADMIN_API_KEY in production.
APP_VERSION_UPDATE_API_KEY=your-secure-update-api-key-here-change-this

# Optional HMAC key for update payload signature verification (X-Update-Signature)
APP_VERSION_UPDATE_HMAC_KEY=optional-hmac-key-for-update-payload

# Database Configuration
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
DB_HOST=your_cloud_sql_ip_here
DB_PORT=3306
DB_USER=ssmaker_user
DB_PASSWORD=your_strong_password_here
DB_NAME=ssmaker_auth

# JWT Secret Key (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
# Or use: openssl rand -hex 32
JWT_SECRET_KEY=your-jwt-secret-key-here-minimum-32-characters
JWT_EXPIRATION_HOURS=72
JWT_EXPIRY_HOURS=24

# API Server URL
API_SERVER_URL=https://ssmaker-auth-api-1049571775048.us-central1.run.app
PAYMENT_API_BASE_URL=https://ssmaker-auth-api-1049571775048.us-central1.run.app

# PayApp (official payrequest API: https://api.payapp.kr/oapi/apiLoad.html)
# Required for /payments/payapp/create and webhook validation
PAYAPP_USERID=your-payapp-userid
PAYAPP_LINKKEY=your-payapp-linkkey
PAYAPP_LINKVAL=your-payapp-linkval
# PayApp feedbackurl is built from PAYMENT_API_BASE_URL + /payments/payapp/webhook.
# Common notify URL in PayApp admin is optional when feedbackurl is sent per request.
# If you still set Common notify URL, use the same webhook URL over HTTPS.
# Optional
PAYAPP_SHOPNAME=NewshoppingShorts
PAYAPP_API_URL=https://api.payapp.kr/oapi/apiLoad.html
PAYAPP_WEBHOOK_ALLOWED_IPS=203.0.113.10,203.0.113.0/24

# Environment (development/production)
ENVIRONMENT=development

# Rate Limiting
MAX_LOGIN_ATTEMPTS=5
LOGIN_ATTEMPT_WINDOW_MINUTES=15
MAX_IP_ATTEMPTS=10

# Trial Settings
FREE_TRIAL_WORK_COUNT=5
DEFAULT_TRIAL_DAYS=365

# Session Settings
SESSION_EXPIRY_DAYS=30
# Consider session stale after heartbeat timeout (seconds)
SESSION_STALE_SECONDS=30
# Backward compatibility (used only when SESSION_STALE_SECONDS is missing)
SESSION_STALE_MINUTES=2
ENFORCE_SESSION_IP_BINDING=false
SESSION_RETENTION_DAYS=7
LOGIN_ATTEMPT_RETENTION_DAYS=30
MAINTENANCE_TASK_INTERVAL_MINUTES=60

# Security
BCRYPT_ROUNDS=12
BILLING_KEY_ENCRYPTION_KEY=replace_with_valid_fernet_key

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/app.log

# CORS Configuration
# WARNING: Never use * (wildcard) in production! Always specify exact origins.
# For multiple origins, use comma-separated list: http://localhost:3000,https://yourdomain.com
ALLOWED_ORIGINS=http://localhost:3000
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# API Key for client authentication (Generate with: openssl rand -hex 32)
SSMAKER_API_KEY=your_api_key_here
